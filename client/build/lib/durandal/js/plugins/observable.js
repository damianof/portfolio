define(["durandal/system","durandal/binder","knockout"],function(t,e,n){function i(t){var e=t[0];return"_"===e||"$"===e}function r(e){return!(!e||void 0===e.nodeType||!t.isNumber(e.nodeType))}function a(t){if(!t||r(t)||t.ko===n||t.jquery)return!1;var e=f.call(t);return-1==v.indexOf(e)&&!(t===!0||t===!1)}function o(t,e){var n=t.__observable__,i=!0;if(!n||!n.__full__){n=n||(t.__observable__={}),n.__full__=!0,p.forEach(function(n){t[n]=function(){i=!1;var t=y[n].apply(e,arguments);return i=!0,t}}),h.forEach(function(n){t[n]=function(){i&&e.valueWillMutate();var r=m[n].apply(t,arguments);return i&&e.valueHasMutated(),r}}),g.forEach(function(n){t[n]=function(){for(var r=0,a=arguments.length;a>r;r++)s(arguments[r]);i&&e.valueWillMutate();var o=m[n].apply(t,arguments);return i&&e.valueHasMutated(),o}}),t.splice=function(){for(var n=2,r=arguments.length;r>n;n++)s(arguments[n]);i&&e.valueWillMutate();var a=m.splice.apply(t,arguments);return i&&e.valueHasMutated(),a};for(var r=0,a=t.length;a>r;r++)s(t[r])}}function s(e){var r,s;if(a(e)&&(r=e.__observable__,!r||!r.__full__)){if(r=r||(e.__observable__={}),r.__full__=!0,t.isArray(e)){var c=n.observableArray(e);o(e,c)}else for(var l in e)i(l)||r[l]||(s=e[l],t.isFunction(s)||u(e,l,s));b&&t.log("Converted",e)}}function c(t,e,n){var i;t(e),i=t.peek(),n?i?i.destroyAll||o(i,t):(i=[],t(i),o(i,t)):s(i)}function u(e,i,r){var a,u,l=e.__observable__||(e.__observable__={});if(void 0===r&&(r=e[i]),t.isArray(r))a=n.observableArray(r),o(r,a),u=!0;else if("function"==typeof r){if(!n.isObservable(r))return null;a=r}else t.isPromise(r)?(a=n.observable(),r.then(function(e){if(t.isArray(e)){var i=n.observableArray(e);o(e,i),e=i}a(e)})):(a=n.observable(r),s(r));return Object.defineProperty(e,i,{configurable:!0,enumerable:!0,get:a,set:n.isWriteableObservable(a)?function(e){e&&t.isPromise(e)?e.then(function(e){c(a,e,t.isArray(e))}):c(a,e,u)}:void 0}),l[i]=a,a}function l(e,i,r){var a,o={owner:e,deferEvaluation:!0};return"function"==typeof r?o.read=r:("value"in r&&t.error('For defineProperty, you must not specify a "value" for the property. You must provide a "get" function.'),"function"!=typeof r.get&&t.error('For defineProperty, the third parameter must be either an evaluator function, or an options object containing a function called "get".'),o.read=r.get,o.write=r.set),a=n.computed(o),e[i]=a,u(e,i,a)}var d,f=Object.prototype.toString,v=["[object Function]","[object String]","[object Boolean]","[object Number]","[object Date]","[object RegExp]"],p=["remove","removeAll","destroy","destroyAll","replace"],h=["pop","reverse","sort","shift","splice"],g=["push","unshift"],m=Array.prototype,y=n.observableArray.fn,b=!1;return d=function(t,e){var i,r,a;return t?(i=t.__observable__,i&&(r=i[e])?r:(a=t[e],n.isObservable(a)?a:u(t,e,a))):null},d.defineProperty=l,d.convertProperty=u,d.convertObject=s,d.install=function(t){var n=e.binding;e.binding=function(t,e,i){i.applyBindings&&!i.skipConversion&&s(t),n(t,e)},b=t.logConversion},d});